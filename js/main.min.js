function init(){var e;raycaster=new THREE.Raycaster,mouse=new THREE.Vector2,container=document.getElementById("container"),camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,1,1100),camera.target=new THREE.Vector3(0,0,0),scene=new THREE.Scene;var n=new THREE.SphereGeometry(500,60,40);n.applyMatrix((new THREE.Matrix4).makeScale(-1,1,1));var o,t=new THREE.Material({transparant:!0}),a=new THREE.BoxGeometry(13,1,1);o=new THREE.Mesh(a,t),o.name="theater",o.position.x=8,scene.add(o),a=new THREE.BoxGeometry(3,2,4),o=new THREE.Mesh(a,t),o.name="box",o.position.x=18,o.position.y=-6,o.position.z=-16,scene.add(o),a=new THREE.BoxGeometry(40,1,40),o=new THREE.Mesh(a,t),o.name="loveletter",o.position.x=-80,o.position.y=-100,o.position.z=190,scene.add(o),a=new THREE.BoxGeometry(440,100,40),o=new THREE.Mesh(a,t),o.name="deportation",o.position.x=350,o.position.y=-100,o.position.z=320,scene.add(o),a=new THREE.BoxGeometry(120,1,120),o=new THREE.Mesh(a,t),o.name="portrait",o.position.x=-10,o.position.y=-360,o.position.z=-250,scene.add(o),tar=o,a=new THREE.BoxGeometry(20,1,15),o=new THREE.Mesh(a,t),o.name="newspaper",o.position.x=-15,o.position.y=-30,o.position.z=0,scene.add(o),a=new THREE.BoxGeometry(30,120,30),o=new THREE.Mesh(a,t),o.name="tijl",o.position.x=-200,o.position.y=40,o.position.z=200,scene.add(o),a=new THREE.BoxGeometry(50,30,100),o=new THREE.Mesh(a,t),o.name="tools",o.position.x=-200,o.position.y=10,o.position.z=0,scene.add(o),a=new THREE.BoxGeometry(50,100,1),o=new THREE.Mesh(a,t),o.name="window",o.position.x=-80,o.position.y=50,o.position.z=-250,scene.add(o),a=new THREE.BoxGeometry(50,180,50),o=new THREE.Mesh(a,t),o.name="coat",o.position.x=-260,o.position.y=50,o.position.z=-120,scene.add(o),a=new THREE.BoxGeometry(50,30,200),o=new THREE.Mesh(a,t),o.name="hooks",o.position.x=-240,o.position.y=100,o.position.z=80,scene.add(o);var i=new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture(imageName)});e=new THREE.Mesh(n,i),scene.add(e),renderer=new THREE.WebGLRenderer,renderer.setSize(window.innerWidth,window.innerHeight),container.appendChild(renderer.domElement),document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1),document.addEventListener("mouseup",onDocumentMouseUp,!1),document.addEventListener("dragover",function(e){e.preventDefault(),e.dataTransfer.dropEffect="copy"},!1),document.addEventListener("dragenter",function(){document.body.style.opacity=.5},!1),document.addEventListener("dragleave",function(){document.body.style.opacity=1},!1),document.addEventListener("drop",function(e){e.preventDefault();var n=new FileReader;n.addEventListener("load",function(e){i.map.image.src=e.target.result,i.map.needsUpdate=!0},!1),n.readAsDataURL(e.dataTransfer.files[0]),document.body.style.opacity=1},!1),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function onDocumentMouseDown(e){e.preventDefault(),isUserInteracting=!0,onPointerDownPointerX=e.clientX,onPointerDownPointerY=e.clientY,onPointerDownLon=lon,onPointerDownLat=lat,mouse.x=e.clientX/window.innerWidth*2-1,mouse.y=2*-(e.clientY/window.innerHeight)+1,render()}function onDocumentMouseMove(e){isUserInteracting===!0&&(lon=.1*(onPointerDownPointerX-e.clientX)+onPointerDownLon,lat=.1*(e.clientY-onPointerDownPointerY)+onPointerDownLat)}function onDocumentMouseUp(){isUserInteracting=!1}function onDocumentMouseWheel(e){e.wheelDeltaY?camera.fov-=.05*e.wheelDeltaY:e.wheelDelta?camera.fov-=.05*e.wheelDelta:e.detail&&(camera.fov+=1*e.detail),camera.updateProjectionMatrix()}function animate(){requestAnimationFrame(animate),update()}function logcamera(){console.log(camera)}function update(){lat=Math.max(-85,Math.min(85,lat)),phi=THREE.Math.degToRad(90-lat),theta=THREE.Math.degToRad(lon),camera.target.x=cameraPosition.x*Math.sin(phi)*Math.cos(theta),camera.target.y=cameraPosition.y*Math.cos(phi),camera.target.z=cameraPosition.z*Math.sin(phi)*Math.sin(theta),camera.lookAt(camera.target),renderer.render(scene,camera)}function render(){raycaster.setFromCamera(mouse,camera);var e=raycaster.intersectObjects(scene.children);renderer.render(scene,camera);var n=e[0].object.name;console.log(n),n.length&&fireEvent(n)}function fireEvent(e){for(var n=events.length-1;n>=0;n--)events[n].name===e&&(overlayOpen||window[events[n].event](events[n].id))}function openOverlay(e){overlay.open(e)}var imageName="img/done.png",camera,scene,renderer,isUserInteracting=!1,onMouseDownMouseX=0,onMouseDownMouseY=0,lon=0,onMouseDownLon=0,lat=0,onMouseDownLat=0,phi=0,theta=0,projector,mouseVector,container,raycaster,mouse,cameraPosition={};cameraPosition.x=500,cameraPosition.y=500,cameraPosition.z=500;var tar;init(),animate();var events=[];events.push({name:"newspaper",event:"openOverlay",id:"#newspaper"}),events.push({name:"coat",event:"openOverlay",id:"#coat"}),events.push({name:"tijl",event:"openOverlay",id:"#tijl"}),events.push({name:"tools",event:"openOverlay",id:"#tools"}),events.push({name:"deportation",event:"openOverlay",id:"#deportation"}),events.push({name:"theater",event:"openOverlay",id:"#forrest"}),events.push({name:"loveletter",event:"openOverlay",id:"#love"}),events.push({name:"portrait",event:"openOverlay",id:"#intro"}),events.push({name:"hooks",event:"openOverlay",id:"#twelve-puppets"}),events.push({name:"box",event:"openOverlay",id:"#credits"}),window.addEventListener("mousemove",onDocumentMouseMove,!1),$("#icons").load("img/icons.svg");var overlayOpen=!1,overlay={};overlay.overlayContainer=$(".overlay"),overlay.open=function(e){this.overlayContainer.fadeIn(500);var n=$(e);if(overlayOpen=!0,$(".modal").hide(),void 0!==n){overlay.overlayContainer.fadeIn(500),n.fadeIn();var o=n.children("video");o.length&&o[0].play()}},overlay.close=function(){overlay.overlayContainer.fadeOut(500),overlayOpen=!1,$(".modal").fadeOut(),$("video")[0].pause()},$(".js-close-overlay").click(overlay.close),$(window).keypress(function(e){27===e.which&&overlay.close()}),overlay.overlayContainer.click(function(e){e.target===this&&overlay.close()}),$(".js-switch-view").click(function(){cameraPosition.x=-110,cameraPosition.y=35,cameraPosition.z=-300}),overlay.open("#intro");